import java.util.ArrayList;
import java.util.Arrays;
import java.util.HashMap;

import org.knowm.xchart.CategoryChart;
import org.knowm.xchart.CategoryChartBuilder;
import org.knowm.xchart.PieChart;
import org.knowm.xchart.SwingWrapper;
import org.knowm.xchart.style.Styler.LegendPosition;

public class SimpleBarChart implements Charts{
	
	HashMap<String, Double> readingLevelBySource;
	double[] xData;
    double[] yData;
    
    
    public SimpleBarChart() {
    	readingLevelBySource = extractSourceReadingLevelData();	
    	
    }
    
    
    public HashMap<String, Double> extractSourceReadingLevelData(){
    	
    	HashMap<String, Double> readingLevelBySource = new HashMap<>();
    	
    	 for (Article article: Charts.articles) {
    		 	String source = article.getSource();
    			double readingLevel = article.getReadingLevel();

    			if (readingLevelBySource.containsKey(source)) {
    				double level = readingLevelBySource.get(source);
    				level += readingLevel;
    				readingLevelBySource.replace(source, level);
	
    				
    			}
    			
    			else {
    				readingLevelBySource.put(source, readingLevel);
    				
    			}		 
    		 
    	 }
    	 
    	 for (String source : readingLevelBySource.keySet()) {
    		double level =  readingLevelBySource.get(source) / 100;
    		readingLevelBySource.replace(source, level);
    		 
    	 }
    	

 		
    	return readingLevelBySource;
    }
    
    
    
    
    
    
    public CategoryChart makeChart() {
    	 
        // Create Chart
        CategoryChart chart = new CategoryChartBuilder().width(800).height(600).title("Average Reading Level by Source").xAxisTitle("Source").yAxisTitle("ReadingLevel").build();
     
        // Customize Chart
        chart.getStyler().setLegendPosition(LegendPosition.InsideNW);
        chart.getStyler().setHasAnnotations(true);
     
        // Series
        
        Object[] xseries = readingLevelBySource.keySet().toArray();
        Double[] yseries = (Double[]) readingLevelBySource.values().toArray();
        
        chart.addSeries("test 1", Arrays.asList(xseries), Arrays.asList(yseries));
        new SwingWrapper<CategoryChart>(chart).displayChart();
        return chart;
      }
    
    
}
